# システムアーキテクチャ

## 概要

Next.js App Router を使用したモノリス構成のフルスタックアプリケーションです。

---

## アーキテクチャ図

```
┌─────────────────────────────────────────────────────────────┐
│                         Client                               │
│  ┌─────────────────────────────────────────────────────────┐│
│  │                    Browser                               ││
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────┐  ││
│  │  │   Server    │  │   Client    │  │   Static Files  │  ││
│  │  │ Components  │  │ Components  │  │   (CSS, Images) │  ││
│  │  └─────────────┘  └─────────────┘  └─────────────────┘  ││
│  └─────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                      Next.js Server                          │
│  ┌─────────────────────────────────────────────────────────┐│
│  │                    App Router                            ││
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────┐  ││
│  │  │   Pages     │  │ API Routes  │  │   Middleware    │  ││
│  │  │  (Server    │  │ /api/*      │  │   (Auth, etc)   │  ││
│  │  │  Components)│  │             │  │                 │  ││
│  │  └─────────────┘  └─────────────┘  └─────────────────┘  ││
│  └─────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                        Supabase                              │
│  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐│
│  │PostgreSQL │  │   Auth    │  │  Storage  │  │ Realtime  ││
│  │    +RLS   │  │           │  │           │  │           ││
│  └───────────┘  └───────────┘  └───────────┘  └───────────┘│
└─────────────────────────────────────────────────────────────┘
```

---

## 技術スタック

| レイヤー | 技術 |
|---------|------|
| Frontend | Next.js (App Router), React, Tailwind CSS |
| Backend | Next.js API Routes |
| Database | Supabase PostgreSQL + Prisma ORM |
| 認証 | Supabase Auth |
| ストレージ | Supabase Storage |
| ホスティング | Vercel (推奨) |

---

## データフロー

### Server Components
```
Server Component → Supabase Server Client → PostgreSQL
```

### Client Components
```
Client Component → Supabase Browser Client → PostgreSQL (with RLS)
```

### API Routes
```
Client → API Route → Prisma → PostgreSQL
                   → External APIs
```

---

**最終更新日**: [日付]
